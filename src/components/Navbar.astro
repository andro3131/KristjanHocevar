---
const navLinks = [
  { href: "#o-meni", label: "O meni" },
  { href: "#videospoti", label: "Videospoti" },
  { href: "#galerija", label: "Galerija" },
  { href: "#kontakt", label: "Kontakt" },
];
---

<nav
  id="navbar"
  class="fixed top-0 left-0 right-0 z-50 transition-all duration-300"
>
  <div class="max-w-none mx-0 px-6 md:px-16 lg:px-24 py-4 flex items-center justify-between">
    <!-- Logotip -->
    <a href="#" class="block hover:opacity-80 transition-opacity">
      <img
        src="https://res.cloudinary.com/dewf3zos0/image/upload/w_400,q_auto,f_auto/v1771234740/logo-KH_ihetrg.png"
        alt="Kristjan Hočevar"
        class="h-16 md:h-18 w-auto"
      />
    </a>

    <!-- Desktop navigacija -->
    <div class="hidden md:flex items-center gap-8">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="nav-link relative text-sm tracking-widest uppercase text-muted hover:text-accent transition-colors"
          >
            {link.label}
          </a>
        ))
      }
    </div>

    <!-- Hamburger -->
    <button
      id="menu-toggle"
      class="md:hidden relative z-50 w-8 h-8 flex flex-col justify-center items-center gap-1.5"
      aria-label="Odpri meni"
    >
      <span
        class="menu-line block w-6 h-0.5 bg-text transition-all duration-300"
      ></span>
      <span
        class="menu-line block w-6 h-0.5 bg-text transition-all duration-300"
      ></span>
      <span
        class="menu-line block w-6 h-0.5 bg-text transition-all duration-300"
      ></span>
    </button>
  </div>

  <!-- Mobilni meni -->
  <div
    id="mobile-menu"
    class="fixed inset-0 bg-bg/95 backdrop-blur-sm flex items-center justify-center transform translate-x-full transition-transform duration-300 md:hidden"
  >
    <div class="flex flex-col items-center gap-8">
      {
        navLinks.map((link) => (
          <a
            href={link.href}
            class="mobile-link text-2xl font-serif text-text hover:text-accent transition-colors"
          >
            {link.label}
          </a>
        ))
      }
    </div>
  </div>
</nav>

<style>
  /* Podčrtaj hover efekt na nav linkih */
  .nav-link::after {
    content: "";
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 1px;
    background-color: var(--color-accent);
    transition: width 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .nav-link:hover::after {
    width: 100%;
  }
</style>

<script>
  const navbar = document.getElementById("navbar")!;
  const menuToggle = document.getElementById("menu-toggle")!;
  const mobileMenu = document.getElementById("mobile-menu")!;
  const menuLines = menuToggle.querySelectorAll(".menu-line");
  const mobileLinks = mobileMenu.querySelectorAll(".mobile-link");

  let isMenuOpen = false;
  let lastScrollY = 0;
  let navHidden = false;

  // Hide/show navbar on scroll
  window.addEventListener("scroll", () => {
    const currentScrollY = window.scrollY;

    // Dodaj ozadje ko scrollaš mimo hero-ja
    if (currentScrollY > 50) {
      navbar.classList.add("bg-bg/90", "backdrop-blur-md", "shadow-lg");
    } else {
      navbar.classList.remove("bg-bg/90", "backdrop-blur-md", "shadow-lg");
    }

    // Skrij/pokaži navbar glede na smer scrollanja
    if (currentScrollY > 300) {
      if (currentScrollY > lastScrollY && !navHidden) {
        // Scrollamo dol → skrij
        navbar.style.transform = "translateY(-100%)";
        navHidden = true;
      } else if (currentScrollY < lastScrollY && navHidden) {
        // Scrollamo gor → pokaži
        navbar.style.transform = "translateY(0)";
        navHidden = false;
      }
    } else {
      navbar.style.transform = "translateY(0)";
      navHidden = false;
    }

    lastScrollY = currentScrollY;
  }, { passive: true });

  // Mobile toggle
  menuToggle.addEventListener("click", () => {
    isMenuOpen = !isMenuOpen;
    if (isMenuOpen) {
      mobileMenu.classList.remove("translate-x-full");
      mobileMenu.classList.add("translate-x-0");
      menuLines[0].classList.add("rotate-45", "translate-y-2");
      menuLines[1].classList.add("opacity-0");
      menuLines[2].classList.add("-rotate-45", "-translate-y-2");
      document.body.style.overflow = "hidden";
    } else {
      closeMenu();
    }
  });

  mobileLinks.forEach((link) => {
    link.addEventListener("click", () => closeMenu());
  });

  function closeMenu() {
    isMenuOpen = false;
    mobileMenu.classList.add("translate-x-full");
    mobileMenu.classList.remove("translate-x-0");
    menuLines[0].classList.remove("rotate-45", "translate-y-2");
    menuLines[1].classList.remove("opacity-0");
    menuLines[2].classList.remove("-rotate-45", "-translate-y-2");
    document.body.style.overflow = "";
  }
</script>
